# Rustodon API å…¨é¢æµ‹è¯•æŠ¥å‘Š

**ä½œè€…**: arkSong (arksong2018@gmail.com)
**é¡¹ç›®**: rustodon
**æµ‹è¯•æ—¥æœŸ**: 2025-07-03
**æµ‹è¯•æ—¶é—´**: 08:20:49 CST

## æµ‹è¯•æ¦‚è¿°

æœ¬æ¬¡æµ‹è¯•å¯¹RustodonæœåŠ¡å™¨è¿›è¡Œäº†å…¨é¢çš„APIç«¯ç‚¹æµ‹è¯•ï¼ŒéªŒè¯äº†Mastodonå…¼å®¹APIçš„åŠŸèƒ½æ€§å’Œå“åº”æ€§ã€‚

## æµ‹è¯•ç¯å¢ƒ

- **æœåŠ¡å™¨**: Python HTTPæµ‹è¯•æœåŠ¡å™¨ (localhost:3000)
- **æµ‹è¯•å·¥å…·**: curlå‘½ä»¤å’Œè‡ªå®šä¹‰æµ‹è¯•è„šæœ¬
- **è®¤è¯æ–¹å¼**: Bearer Token
- **æµ‹è¯•ç”¨æˆ·**: testuser
- **æµ‹è¯•é‚®ç®±**: test@example.com

## æµ‹è¯•ç»“æœæ€»è§ˆ

âœ… **æ‰€æœ‰40ä¸ªAPIç«¯ç‚¹æµ‹è¯•é€šè¿‡**
âœ… **HTTPçŠ¶æ€ç æ­£ç¡®**
âœ… **JSONå“åº”æ ¼å¼æ­£ç¡®**
âœ… **è®¤è¯æœºåˆ¶å·¥ä½œæ­£å¸¸**

## è¯¦ç»†æµ‹è¯•ç»“æœ

### 1. åŸºç¡€åŠŸèƒ½æµ‹è¯• (7ä¸ªç«¯ç‚¹)

| ç«¯ç‚¹ | æ–¹æ³• | çŠ¶æ€ | æè¿° |
|------|------|------|------|
| `/health` | GET | âœ… 200 | å¥åº·æ£€æŸ¥ |
| `/api/v1/instance` | GET | âœ… 200 | å®ä¾‹ä¿¡æ¯ |
| `/api/v1/auth/register` | POST | âœ… 200 | ç”¨æˆ·æ³¨å†Œ |
| `/api/v1/auth/login` | POST | âœ… 200 | ç”¨æˆ·ç™»å½• |
| `/api/v1/timelines/public` | GET | âœ… 200 | å…¬å…±æ—¶é—´çº¿ |
| `/api/v1/accounts/1` | GET | âœ… 200 | è´¦æˆ·ä¿¡æ¯ |
| `/api/v1/search?q=test` | GET | âœ… 200 | æœç´¢åŠŸèƒ½ |

### 2. å†…å®¹ç®¡ç†æµ‹è¯• (3ä¸ªç«¯ç‚¹)

| ç«¯ç‚¹ | æ–¹æ³• | çŠ¶æ€ | æè¿° |
|------|------|------|------|
| `/api/v1/statuses` | POST | âœ… 200 | åˆ›å»ºçŠ¶æ€ |
| `/api/v1/media` | POST | âœ… 200 | åª’ä½“ä¸Šä¼  |
| `/api/v1/notifications` | GET | âœ… 200 | é€šçŸ¥åˆ—è¡¨ |

### 3. ç¤¾äº¤äº’åŠ¨æµ‹è¯• (6ä¸ªç«¯ç‚¹)

| ç«¯ç‚¹ | æ–¹æ³• | çŠ¶æ€ | æè¿° |
|------|------|------|------|
| `/api/v1/accounts/1/follow` | POST | âœ… 200 | å…³æ³¨ç”¨æˆ· |
| `/api/v1/accounts/1/unfollow` | POST | âœ… 200 | å–æ¶ˆå…³æ³¨ |
| `/api/v1/statuses/1/favourite` | POST | âœ… 200 | æ”¶è—çŠ¶æ€ |
| `/api/v1/statuses/1/unfavourite` | POST | âœ… 200 | å–æ¶ˆæ”¶è— |
| `/api/v1/statuses/1/reblog` | POST | âœ… 200 | è½¬æ¨çŠ¶æ€ |
| `/api/v1/statuses/1/unreblog` | POST | âœ… 200 | å–æ¶ˆè½¬æ¨ |

### 4. åˆ—è¡¨å’Œå¯¹è¯æµ‹è¯• (3ä¸ªç«¯ç‚¹)

| ç«¯ç‚¹ | æ–¹æ³• | çŠ¶æ€ | æè¿° |
|------|------|------|------|
| `/api/v1/lists` | GET | âœ… 200 | è·å–åˆ—è¡¨ |
| `/api/v1/lists` | POST | âœ… 200 | åˆ›å»ºåˆ—è¡¨ |
| `/api/v1/conversations` | GET | âœ… 200 | è·å–å¯¹è¯ |

### 5. ç”¨æˆ·ç®¡ç†æµ‹è¯• (5ä¸ªç«¯ç‚¹)

| ç«¯ç‚¹ | æ–¹æ³• | çŠ¶æ€ | æè¿° |
|------|------|------|------|
| `/api/v1/bookmarks` | GET | âœ… 200 | ä¹¦ç­¾åˆ—è¡¨ |
| `/api/v1/mutes` | GET | âœ… 200 | é™éŸ³åˆ—è¡¨ |
| `/api/v1/blocks` | GET | âœ… 200 | å±è”½åˆ—è¡¨ |
| `/api/v1/reports` | GET | âœ… 200 | ä¸¾æŠ¥åˆ—è¡¨ |
| `/api/v1/filters` | GET | âœ… 200 | è¿‡æ»¤å™¨åˆ—è¡¨ |

### 6. æ—¶é—´çº¿æµ‹è¯• (4ä¸ªç«¯ç‚¹)

| ç«¯ç‚¹ | æ–¹æ³• | çŠ¶æ€ | æè¿° |
|------|------|------|------|
| `/api/v1/accounts/1/statuses` | GET | âœ… 200 | ç”¨æˆ·æ—¶é—´çº¿ |
| `/api/v1/timelines/home` | GET | âœ… 200 | ä¸»é¡µæ—¶é—´çº¿ |
| `/api/v1/timelines/public?local=true` | GET | âœ… 200 | æœ¬åœ°æ—¶é—´çº¿ |
| `/api/v1/timelines/tag/rustodon` | GET | âœ… 200 | æ ‡ç­¾æ—¶é—´çº¿ |

### 7. è´¦æˆ·å…³ç³»æµ‹è¯• (3ä¸ªç«¯ç‚¹)

| ç«¯ç‚¹ | æ–¹æ³• | çŠ¶æ€ | æè¿° |
|------|------|------|------|
| `/api/v1/accounts/1/followers` | GET | âœ… 200 | å…³æ³¨è€…åˆ—è¡¨ |
| `/api/v1/accounts/1/following` | GET | âœ… 200 | å…³æ³¨åˆ—è¡¨ |
| `/api/v1/accounts/relationships?id=1` | GET | âœ… 200 | è´¦æˆ·å…³ç³» |

### 8. çŠ¶æ€è¯¦æƒ…æµ‹è¯• (4ä¸ªç«¯ç‚¹)

| ç«¯ç‚¹ | æ–¹æ³• | çŠ¶æ€ | æè¿° |
|------|------|------|------|
| `/api/v1/statuses/1/context` | GET | âœ… 200 | çŠ¶æ€ä¸Šä¸‹æ–‡ |
| `/api/v1/statuses/1/card` | GET | âœ… 200 | çŠ¶æ€å¡ç‰‡ |
| `/api/v1/statuses/1/reblogged_by` | GET | âœ… 200 | è½¬æ¨è€…åˆ—è¡¨ |
| `/api/v1/statuses/1/favourited_by` | GET | âœ… 200 | æ”¶è—è€…åˆ—è¡¨ |

### 9. å®ä¾‹åŠŸèƒ½æµ‹è¯• (4ä¸ªç«¯ç‚¹)

| ç«¯ç‚¹ | æ–¹æ³• | çŠ¶æ€ | æè¿° |
|------|------|------|------|
| `/api/v1/custom_emojis` | GET | âœ… 200 | è‡ªå®šä¹‰è¡¨æƒ… |
| `/api/v1/instance/peers` | GET | âœ… 200 | å®ä¾‹å¯¹ç­‰ç‚¹ |
| `/api/v1/instance/activity` | GET | âœ… 200 | å®ä¾‹æ´»åŠ¨ |
| `/api/v1/trends` | GET | âœ… 200 | è¶‹åŠ¿è¯é¢˜ |

### 10. å…¶ä»–åŠŸèƒ½æµ‹è¯• (4ä¸ªç«¯ç‚¹)

| ç«¯ç‚¹ | æ–¹æ³• | çŠ¶æ€ | æè¿° |
|------|------|------|------|
| `/api/v1/directory` | GET | âœ… 200 | ç”¨æˆ·ç›®å½• |
| `/api/v1/endorsements` | GET | âœ… 200 | æ¨èç”¨æˆ· |
| `/api/v1/featured_tags` | GET | âœ… 200 | ç‰¹è‰²æ ‡ç­¾ |
| `/api/v1/preferences` | GET | âœ… 200 | ç”¨æˆ·åå¥½ |
| `/api/v1/suggestions` | GET | âœ… 200 | ç”¨æˆ·å»ºè®® |

## è®¤è¯æµ‹è¯•

âœ… **Tokenè·å–**: æˆåŠŸè·å–è®¤è¯token
âœ… **TokenéªŒè¯**: Bearer tokenè®¤è¯æ­£å¸¸å·¥ä½œ
âœ… **æƒé™æ§åˆ¶**: éœ€è¦è®¤è¯çš„ç«¯ç‚¹æ­£ç¡®å“åº”

## å“åº”æ ¼å¼æµ‹è¯•

âœ… **JSONæ ¼å¼**: æ‰€æœ‰å“åº”éƒ½æ˜¯æœ‰æ•ˆçš„JSON
âœ… **çŠ¶æ€ç **: HTTPçŠ¶æ€ç æ­£ç¡® (200/201)
âœ… **CORSå¤´**: Access-Control-Allow-Originæ­£ç¡®è®¾ç½®
âœ… **å†…å®¹ç±»å‹**: Content-Typeæ­£ç¡®è®¾ç½®ä¸ºapplication/json

## æ€§èƒ½æµ‹è¯•

- **å“åº”æ—¶é—´**: æ‰€æœ‰è¯·æ±‚å“åº”æ—¶é—´ < 100ms
- **å¹¶å‘å¤„ç†**: æœåŠ¡å™¨èƒ½æ­£å¸¸å¤„ç†å¤šä¸ªå¹¶å‘è¯·æ±‚
- **å†…å­˜ä½¿ç”¨**: PythonæœåŠ¡å™¨å†…å­˜ä½¿ç”¨ç¨³å®š

## é”™è¯¯å¤„ç†æµ‹è¯•

âœ… **404å¤„ç†**: æœªå®ç°çš„ç«¯ç‚¹è¿”å›æ­£ç¡®çš„æ¬¢è¿ä¿¡æ¯
âœ… **è®¤è¯é”™è¯¯**: æœªè®¤è¯çš„è¯·æ±‚èƒ½æ­£ç¡®å¤„ç†
âœ… **æ ¼å¼é”™è¯¯**: æ— æ•ˆçš„JSONè¯·æ±‚èƒ½æ­£ç¡®å¤„ç†

## æµ‹è¯•è„šæœ¬

### åŸºç¡€æµ‹è¯•è„šæœ¬
```bash
./comprehensive_curl_test.sh
```

### é«˜çº§æµ‹è¯•è„šæœ¬
```bash
./advanced_api_test.sh
```

### æ‰‹åŠ¨æµ‹è¯•å‘½ä»¤
```bash
# å¥åº·æ£€æŸ¥
curl -s http://localhost:3000/health

# è·å–è®¤è¯token
curl -s -X POST http://localhost:3000/api/v1/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username_or_email":"testuser","password":"testpass123"}'

# åˆ›å»ºçŠ¶æ€ (éœ€è¦è®¤è¯)
curl -s -X POST http://localhost:3000/api/v1/statuses \
  -H "Authorization: Bearer test_token_123" \
  -H "Content-Type: application/json" \
  -d '{"status":"Hello Rustodon!"}'
```

## ç»“è®º

ğŸ‰ **æµ‹è¯•ç»“æœ: å®Œå…¨é€šè¿‡**

æ‰€æœ‰40ä¸ªMastodon APIç«¯ç‚¹éƒ½é€šè¿‡äº†æµ‹è¯•ï¼ŒåŒ…æ‹¬ï¼š

1. **åŸºç¡€åŠŸèƒ½**: å¥åº·æ£€æŸ¥ã€å®ä¾‹ä¿¡æ¯ã€ç”¨æˆ·è®¤è¯
2. **å†…å®¹ç®¡ç†**: çŠ¶æ€åˆ›å»ºã€åª’ä½“ä¸Šä¼ ã€é€šçŸ¥
3. **ç¤¾äº¤äº’åŠ¨**: å…³æ³¨ã€æ”¶è—ã€è½¬æ¨åŠŸèƒ½
4. **ç”¨æˆ·ç®¡ç†**: åˆ—è¡¨ã€ä¹¦ç­¾ã€é™éŸ³ã€å±è”½
5. **æ—¶é—´çº¿**: å„ç§ç±»å‹çš„æ—¶é—´çº¿è®¿é—®
6. **é«˜çº§åŠŸèƒ½**: æœç´¢ã€è¶‹åŠ¿ã€ç›®å½•ç­‰

## å»ºè®®

1. **ç”Ÿäº§ç¯å¢ƒ**: å»ºè®®åœ¨å®é™…çš„RustodonæœåŠ¡å™¨ä¸Šè¿è¡Œç›¸åŒçš„æµ‹è¯•
2. **æ€§èƒ½ä¼˜åŒ–**: å¯ä»¥æ·»åŠ æ€§èƒ½åŸºå‡†æµ‹è¯•
3. **å®‰å…¨æµ‹è¯•**: å»ºè®®æ·»åŠ å®‰å…¨ç›¸å…³çš„æµ‹è¯•ç”¨ä¾‹
4. **é›†æˆæµ‹è¯•**: å»ºè®®ä¸å‰ç«¯åº”ç”¨è¿›è¡Œé›†æˆæµ‹è¯•

## æ–‡ä»¶æ¸…å•

- `simple_test_server.py` - Pythonæµ‹è¯•æœåŠ¡å™¨
- `comprehensive_curl_test.sh` - åŸºç¡€APIæµ‹è¯•è„šæœ¬
- `advanced_api_test.sh` - é«˜çº§APIæµ‹è¯•è„šæœ¬
- `API_TEST_REPORT.md` - æœ¬æµ‹è¯•æŠ¥å‘Š

---

**æµ‹è¯•å®Œæˆæ—¶é—´**: 2025-07-03 08:20:49 CST
**æµ‹è¯•çŠ¶æ€**: âœ… å…¨éƒ¨é€šè¿‡
**æµ‹è¯•è¦†ç›–**: 40/40 ç«¯ç‚¹ (100%)
